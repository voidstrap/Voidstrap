<ui:UiPage
    x:Class="Voidstrap.UI.Elements.Settings.Pages.PluginsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:Voidstrap.UI.Elements.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Voidstrap.UI.Elements.Settings.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="clr-namespace:Voidstrap.UI.ViewModels.Settings"
    xmlns:resources="clr-namespace:Voidstrap.Resources"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="Plugins Page"
    d:DataContext="{d:DesignInstance Type=models:PluginsViewModel}"
    d:DesignHeight="1200"
    d:DesignWidth="800"
    Scrollable="True"
    mc:Ignorable="d">

    <StackPanel Margin="0,0,14,14">
        <TextBlock Margin="0,0,0,16" FontSize="14" Text="Plugins Manager (EARLY ACCESS)" />
        <TabControl>
            <TabItem Header="Play Area">
                <Grid Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <ListBox Grid.Row="1"
                             ItemsSource="{Binding LoadedPlugins}"
                             SelectedItem="{Binding SelectedPlugin}"
                             DisplayMemberPath="Name"/>
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                        <ui:Button Content="Run Selected" Command="{Binding RunPluginCommand}" />
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Code Editor -->
            <TabItem Header="Code Editor">
                <Grid Margin="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <!-- Add plugin input -->
                        <RowDefinition Height="*"/>
                        <!-- Code editors -->
                        <RowDefinition Height="Auto"/>
                        <!-- Buttons -->
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,0,0,8" VerticalAlignment="Center">
                        <TextBlock Text="Name" FontWeight="Medium" Margin="0,0,8,0" VerticalAlignment="Center"/>
                        <TextBox Width="727"  
             Text="{Binding NewPluginName, Mode=TwoWay}" />
                    </StackPanel>

                    <StackPanel Grid.Row="1" Grid.Column="0">
                        <TextBlock Text="XAML Code" FontWeight="Medium" Margin="0,0,0,4"/>
                        <TextBox Text="{Binding PluginXamlCode, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
             AcceptsReturn="True"
             VerticalScrollBarVisibility="Auto" 
             HorizontalScrollBarVisibility="Auto"
             VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
             Height="300"
             FontSize="14" TextWrapping="Wrap"/>
                    </StackPanel>

                    <!-- C# Editor -->
                    <StackPanel Grid.Row="1" Grid.Column="1">
                        <TextBlock Text="C# Code" FontWeight="Medium" Margin="0,0,0,4"/>
                        <TextBox Text="{Binding PluginCsCode, Mode=TwoWay}" 
             AcceptsReturn="True"
             VerticalScrollBarVisibility="Auto" 
             HorizontalScrollBarVisibility="Auto"
             VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
             Height="300"
             FontSize="14" TextWrapping="Wrap"/>
                    </StackPanel>


                    <!-- Buttons -->
                    <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                        <ui:Button Content="Compile and Load" Command="{Binding CompileAndLoadPluginCommand}"/>
                        <ui:Button Content="Save Plugin" Command="{Binding SavePluginCommand}"/>
                        <ui:Button Content="New Plugin" Command="{Binding NewPluginCommand}"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Live Preview -->
            <TabItem Header="Live Preview">
                <Border Margin="8" Height="450" BorderThickness="1" BorderBrush="Gray">
                    <ContentControl Content="{Binding PluginPreview}" />
                </Border>
            </TabItem>

            <!-- Public Plugins -->
            <TabItem Header="Public Plugins (PLACEHOLDER WIP)">
                <Grid Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <ListView Grid.Row="0" ItemsSource="{Binding PublicPlugins}" SelectedItem="{Binding SelectedPublicPlugin}">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="200"/>
                                <GridViewColumn Header="Author" DisplayMemberBinding="{Binding Author}" Width="150"/>
                                <GridViewColumn Header="Description" DisplayMemberBinding="{Binding Description}" Width="400"/>
                            </GridView>
                        </ListView.View>
                    </ListView>

                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                        <ui:Button Content="Download and Load" Command="{Binding LoadPublicPluginCommand}"/>
                        <ui:Button Content="Refresh List" Command="{Binding RefreshPublicPluginsCommand}"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
    </StackPanel>
</ui:UiPage>
