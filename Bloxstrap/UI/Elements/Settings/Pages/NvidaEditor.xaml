<ui:UiPage
    x:Class="Voidstrap.UI.Elements.Settings.Pages.NvidiaFFlagEditorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:resources="clr-namespace:Voidstrap.Resources"
    xmlns:settings="clr-namespace:Voidstrap.UI.ViewModels.Settings"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="NVIDIA FFlag Editor"
    d:DataContext="{d:DesignInstance Type=settings:ModsViewModel}"
    d:DesignHeight="600"
    d:DesignWidth="900"
    mc:Ignorable="d">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0,0,0,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <ui:Button
        Grid.Column="0"
        Content="Add New"
        Icon="AddCircle24"
        Click="Add_Click"/>

            <ui:TextBox
        Grid.Column="1"
        Margin="8,0"
        Height="32"
        VerticalContentAlignment="Center"
        PlaceholderText="Search Flags…"
        Icon="Search24"
        TextChanged="SearchTextBox_TextChanged"/>
            
            <StackPanel Grid.Column="2" Orientation="Horizontal">
                <ui:Button
            Content="Delete Selected"
            Icon="Delete24"
            Appearance="Secondary"
            Click="DeleteSelected_Click"/>

                <ui:Button Margin="8,0,0,0"
            Content="Delete All"
            Icon="DeleteDismiss24"
            Appearance="Danger"
            Click="DeleteAll_Click"/>
            </StackPanel>
        </Grid>

        <Border
            Grid.Row="1"
            CornerRadius="8"
            Background="{DynamicResource ControlFillColorPrimaryBrush}"
            BorderBrush="{DynamicResource ControlElevationBorderBrush}"
            BorderThickness="1"
            ClipToBounds="True"
            Effect="{DynamicResource ControlElevationShadow}">

            <DataGrid
                x:Name="DataGridRef"
                ItemsSource="{Binding EntriesView}"
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                CanUserDeleteRows="True"
                CanUserReorderColumns="False"
                IsReadOnly="False"
                RowHeight="32"
                HeadersVisibility="Column"
                GridLinesVisibility="None"
                AlternatingRowBackground="{DynamicResource ControlFillColorSecondaryBrush}"
                Background="Transparent"
                BorderThickness="0"
                ScrollViewer.VerticalScrollBarVisibility="Auto"
                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                CellEditEnding="DataGrid_CellEditEnding"
                CurrentCellChanged="DataGrid_CurrentCellChanged">

                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="{DynamicResource ControlFillColorTertiaryBrush}" />
                        <Setter Property="Height" Value="32" />
                        <Setter Property="Padding" Value="10,0,10,0" />
                        <Setter Property="BorderBrush" Value="{DynamicResource ControlElevationBorderBrush}" />
                        <Setter Property="BorderThickness" Value="0 0 1 1" />
                        <Setter Property="HorizontalContentAlignment" Value="Left" />
                        <Setter Property="FontWeight" Value="Medium" />
                    </Style>
                </DataGrid.ColumnHeaderStyle>

                <!-- CELLS -->
                <DataGrid.CellStyle>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="8,0,8,0"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Foreground" Value="{DynamicResource TextOnAccentFillColorPrimaryBrush}" />
                                <Setter Property="Background" Value="{DynamicResource SystemAccentColorSecondaryBrush}" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.CellStyle>

                <DataGrid.Columns>

                    <DataGridTextColumn
                        Header="Setting Name"
                        Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Width="2*" />

                    <DataGridTextColumn
                        Header="Setting ID"
                        Binding="{Binding SettingId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Width="*" />

                    <DataGridTextColumn
                        Header="Value"
                        Binding="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Width="*" />

                    <DataGridTemplateColumn Header="Value Type" Width="*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding ValueType}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>

                        <DataGridTemplateColumn.CellEditingTemplate>
                            <DataTemplate>
                                <ComboBox
                                    ItemsSource="{Binding DataContext.ValueTypes, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                    SelectedItem="{Binding ValueType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellEditingTemplate>
                    </DataGridTemplateColumn>

                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <Border
    Grid.Row="2"
    Margin="0,12,0,0"
    Padding="8">

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">

                <ui:Button
    Content="Back"
    Appearance="Secondary"
    Margin="0,0,8,0"
    Click="BackButton"/>

                <ui:Button
        Content="Copy"
        Icon="Copy24"
        Appearance="Secondary"
        Margin="0,0,8,0"
        Click="CopySelected_Click"/>

                <ui:Button
            Content="Export .NIP"
            Icon="ArrowExit20"
            Appearance="Secondary"
            Margin="0,0,8,0"
            Click="ExportNip_Click"/>

                <ui:Button Margin="0,0,8,0"
                Content="Reset NIP"
                Appearance="Danger"
                Icon="DeleteDismiss24"
                Click="ResetNipFile_Click"/>

                <ui:Button
            Content="Apply"
            Icon="CheckmarkCircle24"
            Click="Apply_Click"/>

            </StackPanel>
        </Border>
    </Grid>
</ui:UiPage>
