<ui:UiPage
    x:Class="Voidstrap.UI.Elements.Settings.Pages.HubPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:conv="clr-namespace:Voidstrap.UI.Converters"
    x:Name="HubPageView"
    Title="HubPage"
    d:DesignWidth="800"
    Scrollable="True"
    mc:Ignorable="d">

    <ui:UiPage.Resources>
        <conv:BooleanToVisibilityConverter x:Key="BoolToVis" />
    </ui:UiPage.Resources>

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Search at the top (row 0) -->
        <ui:TextBox
        x:Name="SearchBox"
        Height="32"
        Margin="0,0,0,12"
        HorizontalContentAlignment="Left"
        VerticalContentAlignment="Center"
        BorderThickness="0"
        FocusVisualStyle="{x:Null}"
        FontSize="14"
        Icon="Search48"
        PlaceholderText="Search Releases..."
        TextChanged="SearchBox_TextChanged" />

        <!-- Releases below (row 1) -->
        <ScrollViewer
        Grid.Row="1"
        VerticalScrollBarVisibility="Auto"
        HorizontalScrollBarVisibility="Disabled">
            <ItemsControl ItemsSource="{Binding Releases}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border
                        Margin="0,0,0,12"
                        Padding="10"
                        CornerRadius="8"
                        BorderThickness="1"
BorderBrush="#803A3A3A"



>
                            <StackPanel>
                                <TextBlock
                                FontSize="16"
                                FontWeight="Bold"
                                Text="{Binding Name}" />

                                <StackPanel
                                Margin="0,4,0,4"
                                Orientation="Horizontal">
                                    <TextBlock
                                    Margin="0,0,8,0"
                                    FontWeight="SemiBold"
                                    Foreground="DodgerBlue"
                                    Text="{Binding TagName}" />
                                    <TextBlock
                                    Margin="0,0,8,0"
                                    Foreground="Gray"
                                    Text="{Binding PublishedAt, StringFormat='Published: {0:yyyy-MM-dd HH:mm}'}" />
                                    <TextBlock
                                    Margin="0,0,8,0"
                                    Foreground="OrangeRed"
                                    Text="Pre-release"
                                    Visibility="{Binding Prerelease, Converter={StaticResource BoolToVis}}" />
                                    <TextBlock
                                    Margin="0,0,8,0"
                                    Foreground="Tomato"
                                    Text="Draft"
                                    Visibility="{Binding Draft, Converter={StaticResource BoolToVis}}" />
                                </StackPanel>

                                <TextBlock Margin="0,0,0,4">
                                <Hyperlink
                                    NavigateUri="{Binding HtmlUrl}"
                                    RequestNavigate="Hyperlink_RequestNavigate">
                                    <Run Text="View on GitHub" />
                                </Hyperlink>
                                </TextBlock>
                                
                                <TextBox
                                Margin="0,4,0,4"
                                IsReadOnly="True"
                                TextWrapping="Wrap"
                                AcceptsReturn="True"
                                BorderThickness="0"
                                Background="Transparent"
                                Foreground="White"
                                VerticalScrollBarVisibility="Auto"
                                Height="120"
                                Text="{Binding Body}" />

                                <StackPanel
                                Margin="0,4,0,4"
                                Orientation="Horizontal">
                                    <TextBlock
                                    Margin="0,0,12,0"
                                    Foreground="Gray"
                                    Text="{Binding Assets.Length, StringFormat='Assets: {0}'}" />
                                    <TextBlock
                                    Margin="0,0,12,0"
                                    Foreground="Gray"
                                    Text="{Binding TotalDownloads, StringFormat='Total downloads: {0}'}" />
                                </StackPanel>

                                <ItemsControl
                                Margin="0,4,0,0"
                                ItemsSource="{Binding Assets}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border
                                            Margin="0,2,0,2"
                                            Padding="6"
                                            CornerRadius="4"
                                            Background="#202020">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Margin="0,0,8,0">
                                                    <Hyperlink
                                                        NavigateUri="{Binding BrowserDownloadUrl}"
                                                        RequestNavigate="Hyperlink_RequestNavigate">
                                                        <Run Text="{Binding Name}" />
                                                    </Hyperlink>
                                                    </TextBlock>
                                                    <TextBlock
                                                    Margin="0,0,8,0"
                                                    Foreground="Gray"
                                                    Text="{Binding SizeMb, StringFormat='({0:F2} MB)'}" />
                                                    <TextBlock
                                                    Margin="0,0,8,0"
                                                    Foreground="Gray"
                                                    Text="{Binding DownloadCount, StringFormat='Downloads: {0}'}" />
                                                    <TextBlock
                                                    Foreground="Gray"
                                                    Text="{Binding ContentType}" />
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>

                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>

</ui:UiPage>
